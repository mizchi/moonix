// Generated by moon-component
// Import module: wasi:sockets/network@0.2.9

///|
pub(all) enum ErrorCode {
  Unknown
  AccessDenied
  NotSupported
  InvalidArgument
  OutOfMemory
  Timeout
  ConcurrencyConflict
  NotInProgress
  WouldBlock
  InvalidState
  NewSocketLimit
  AddressNotBindable
  AddressInUse
  RemoteUnreachable
  ConnectionRefused
  ConnectionReset
  ConnectionAborted
  DatagramTooLarge
  NameUnresolvable
  TemporaryResolverFailure
  PermanentResolverFailure
} derive(Show, Eq)

///|
pub fn ErrorCode::from_ordinal(ord : Int) -> ErrorCode {
  match ord {
    0 => Unknown
    1 => AccessDenied
    2 => NotSupported
    3 => InvalidArgument
    4 => OutOfMemory
    5 => Timeout
    6 => ConcurrencyConflict
    7 => NotInProgress
    8 => WouldBlock
    9 => InvalidState
    10 => NewSocketLimit
    11 => AddressNotBindable
    12 => AddressInUse
    13 => RemoteUnreachable
    14 => ConnectionRefused
    15 => ConnectionReset
    16 => ConnectionAborted
    17 => DatagramTooLarge
    18 => NameUnresolvable
    19 => TemporaryResolverFailure
    20 => PermanentResolverFailure
    _ => abort("invalid ordinal")
  }
}

///|
pub fn ErrorCode::ordinal(self : ErrorCode) -> Int {
  match self {
    Unknown => 0
    AccessDenied => 1
    NotSupported => 2
    InvalidArgument => 3
    OutOfMemory => 4
    Timeout => 5
    ConcurrencyConflict => 6
    NotInProgress => 7
    WouldBlock => 8
    InvalidState => 9
    NewSocketLimit => 10
    AddressNotBindable => 11
    AddressInUse => 12
    RemoteUnreachable => 13
    ConnectionRefused => 14
    ConnectionReset => 15
    ConnectionAborted => 16
    DatagramTooLarge => 17
    NameUnresolvable => 18
    TemporaryResolverFailure => 19
    PermanentResolverFailure => 20
  }
}

///|
pub(all) enum IpAddress {
  Ipv4((Byte, Byte, Byte, Byte))
  Ipv6((UInt, UInt, UInt, UInt, UInt, UInt, UInt, UInt))
} derive(Show, Eq)

///|
pub(all) enum IpAddressFamily {
  Ipv4
  Ipv6
} derive(Show, Eq)

///|
pub fn IpAddressFamily::from_ordinal(ord : Int) -> IpAddressFamily {
  match ord {
    0 => Ipv4
    1 => Ipv6
    _ => abort("invalid ordinal")
  }
}

///|
pub fn IpAddressFamily::ordinal(self : IpAddressFamily) -> Int {
  match self {
    Ipv4 => 0
    Ipv6 => 1
  }
}

///|
pub(all) enum IpSocketAddress {
  Ipv4(Ipv4SocketAddress)
  Ipv6(Ipv6SocketAddress)
} derive(Show, Eq)

///|
pub(all) struct Ipv4SocketAddress {
  port : UInt
  address : (Byte, Byte, Byte, Byte)
} derive(Show, Eq)

///|
pub(all) struct Ipv6SocketAddress {
  port : UInt
  flow_info : UInt
  address : (UInt, UInt, UInt, UInt, UInt, UInt, UInt, UInt)
  scope_id : UInt
} derive(Show, Eq)

///|
pub(all) struct Network(Int) derive(Show, Eq)

///| Low-level FFI import
fn ffi_network_error_code(p0 : Int, retptr : Int) -> Int = "wasi:sockets/network@0.2.9" "network-error-code"

///| High-level wrapper with canonical ABI conversion
pub fn network_error_code(err : @error.IoError) -> ErrorCode? {
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  let _ = ffi_network_error_code(err.0, retptr)
  match @cabi.cabi_read_i32(retptr) {
    0 => None
    _ => Some(ErrorCode::from_ordinal(@cabi.cabi_read_i32(retptr + 4)))
  }
}

