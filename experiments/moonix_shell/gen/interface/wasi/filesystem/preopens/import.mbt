// Generated by moon-component
// Import module: wasi:filesystem/preopens@0.2.9

///| Low-level FFI import
fn ffi_get_directories(retptr : Int) -> Int = "wasi:filesystem/preopens@0.2.9" "get-directories"

///| High-level wrapper with canonical ABI conversion
pub fn get_directories() -> Array[(@fs_types.Descriptor, String)] {
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  let _ = ffi_get_directories(retptr)
  let result_ptr = @cabi.cabi_read_i32(retptr)
  let result_len = @cabi.cabi_read_i32(retptr + 4)
  let result : Array[(@fs_types.Descriptor, String)] = {
    let arr : Array[(@fs_types.Descriptor, String)] = Array::new(capacity=result_len)
    for i = 0; i < result_len; i = i + 1 {
      let elem_ptr = result_ptr + i * 12
      arr.push((@fs_types.Descriptor(@cabi.cabi_read_i32(elem_ptr + 0)), @cabi.cabi_lift_string(@cabi.cabi_read_i32(elem_ptr + 4), @cabi.cabi_read_i32(elem_ptr + 4 + 4))))
    }
    arr
  }
  result
}

