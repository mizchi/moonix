// Generated by moon-component
// Import module: wasi:cli/environment@0.2.9

///| Low-level FFI import
fn ffi_get_arguments(retptr : Int) -> Int = "wasi:cli/environment@0.2.9" "get-arguments"

///| High-level wrapper with canonical ABI conversion
pub fn get_arguments() -> Array[String] {
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  let _ = ffi_get_arguments(retptr)
  let result_ptr = @cabi.cabi_read_i32(retptr)
  let result_len = @cabi.cabi_read_i32(retptr + 4)
  let result : Array[String] = {
    let arr : Array[String] = Array::new(capacity=result_len)
    for i = 0; i < result_len; i = i + 1 {
      let elem_ptr = result_ptr + i * 8
      arr.push(@cabi.cabi_lift_string(@cabi.cabi_read_i32(elem_ptr), @cabi.cabi_read_i32(elem_ptr + 4)))
    }
    arr
  }
  result
}

///| Low-level FFI import
fn ffi_get_environment(retptr : Int) -> Int = "wasi:cli/environment@0.2.9" "get-environment"

///| High-level wrapper with canonical ABI conversion
pub fn get_environment() -> Array[(String, String)] {
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  let _ = ffi_get_environment(retptr)
  let result_ptr = @cabi.cabi_read_i32(retptr)
  let result_len = @cabi.cabi_read_i32(retptr + 4)
  let result : Array[(String, String)] = {
    let arr : Array[(String, String)] = Array::new(capacity=result_len)
    for i = 0; i < result_len; i = i + 1 {
      let elem_ptr = result_ptr + i * 16
      arr.push((@cabi.cabi_lift_string(@cabi.cabi_read_i32(elem_ptr + 0), @cabi.cabi_read_i32(elem_ptr + 0 + 4)), @cabi.cabi_lift_string(@cabi.cabi_read_i32(elem_ptr + 8), @cabi.cabi_read_i32(elem_ptr + 8 + 4))))
    }
    arr
  }
  result
}

///| Low-level FFI import
fn ffi_initial_cwd(retptr : Int) -> Int = "wasi:cli/environment@0.2.9" "initial-cwd"

///| High-level wrapper with canonical ABI conversion
pub fn initial_cwd() -> String? {
  let retptr = @cabi.cabi_realloc(0, 0, 4, 12)
  let _ = ffi_initial_cwd(retptr)
  match @cabi.cabi_read_i32(retptr) {
    0 => None
    _ => Some(@cabi.cabi_lift_string(@cabi.cabi_read_i32(retptr + 4), @cabi.cabi_read_i32(retptr + 4 + 4)))
  }
}

