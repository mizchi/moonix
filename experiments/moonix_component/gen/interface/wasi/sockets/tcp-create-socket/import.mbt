// Generated by moon-component
// Import module: wasi:sockets/tcp-create-socket@0.2.9

type IpAddressFamily = @network.IpAddressFamily

type ErrorCode = @network.ErrorCode

///| Low-level FFI import
fn ffi_create_tcp_socket(p0 : Int, retptr : Int) -> Int = "wasi:sockets/tcp-create-socket@0.2.9" "create-tcp-socket"

///| High-level wrapper with canonical ABI conversion
pub fn create_tcp_socket(address_family : IpAddressFamily) -> Result[@tcp.TcpSocket, ErrorCode] {
  let retptr = @cabi.cabi_realloc(0, 0, 4, 8)
  let _ = ffi_create_tcp_socket(address_family.ordinal(), retptr)
  match @cabi.cabi_read_i32(retptr) {
    0 => Ok(@tcp.TcpSocket(@cabi.cabi_read_i32(retptr + 4)))
    _ => Err(ErrorCode::from_ordinal(@cabi.cabi_read_i32(retptr + 4)))
  }
}
